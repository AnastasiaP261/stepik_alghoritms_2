# –ó–∞–¥–∞—á–∏ —Å –∫—É—Ä—Å–∞ Stepik "–ê–ª–≥–æ—Ä–∏—Ç–º—ã: –¢–µ–æ—Ä–∏—è –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞. –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö"
[C—Å—ã–ª–∫–∞ –Ω–∞ –∫—É—Ä—Å](https://stepik.org/course/1547/info)

–í —ç—Ç–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —è –±—É–¥—É –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å–æ–±–∏—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á —Å–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –∫—É—Ä—Å–∞ –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º.


###  –°—Ç–∞—Ç—É—Å—ã –∑–∞–¥–∞—á:
- üü¢ - –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞ –∏ –ø—Ä–æ—à–ª–∞ –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ç–µ—Å—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- üü° - –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞, –Ω–æ –Ω–µ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—Ä–æ–π–¥–µ–Ω—ã

### –î—Ä—É–≥–∏–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:
- <kbd>file_name</kbd> - –∏–º—è —Ñ–∞–π–ª–∞ —Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏

###  –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
1. üü¢ [–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫–æ–±–æ–∫ –≤ –∫–æ–¥–µ](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D1%80%D0%B0%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-%D1%81%D0%BA%D0%BE%D0%B1%D0%BE%D0%BA-%D0%B2-%D0%BA%D0%BE%D0%B4%D0%B5)
    <kbd>brace_placement.py</kbd>
2. üü¢ [–í—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D0%B2%D1%8B%D1%81%D0%BE%D1%82%D0%B0-%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%B0)
    <kbd>tree_height.py</kbd>
3. üü¢ [–°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D1%81%D0%B8%D0%BC%D1%83%D0%BB%D1%8F%D1%86%D0%B8%D1%8F-%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2)
    <kbd>network_packet_processing.py</kbd> 
4. üü¢ [–°—Ç–µ–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞–∫—Å–∏–º—É–º–∞](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D1%81%D1%82%D0%B5%D0%BA-%D1%81-%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%BE%D0%B9-%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D1%83%D0%BC%D0%B0)
    <kbd>stack_with_max.py</kbd>   
5. üü¢ [–ú–∞–∫—Å–∏–º—É–º –≤ —Å–∫–æ–ª—å–∑—è—â–µ–º –æ–∫–Ω–µ](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D0%BC%D0%B0%D0%BA%D1%81%D0%B8%D0%BC%D1%83%D0%BC-%D0%B2-%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%B7%D1%8F%D1%89%D0%B5%D0%BC-%D0%BE%D0%BA%D0%BD%D0%B5)
    <kbd>max_in_a_sliding_window.py</kbd>
6. üü¢ [–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—É—á–∏](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D0%BF%D0%BE%D1%81%D1%82%D1%80%D0%BE%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BA%D1%83%D1%87%D0%B8)
    <kbd>heap_building.py</kbd>   
7. üü¢ [–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D0%BF%D0%B0%D1%80%D0%B0%D0%BB%D0%BB%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F-%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0)
    <kbd>parallel_proc.py</kbd>   
8. üü¢ [–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü](https://github.com/AnastasiaP261/stepik_alghoritms_2#%D0%BE%D0%B1%D1%8A%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86)
    <kbd>sys_of_disjoint_sets.py</kbd>   
   
## –†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫–æ–±–æ–∫ –≤ –∫–æ–¥–µ
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>**–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –°—Ç—Ä–æ–∫–∞ _s[1..n]_, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –∏ –ø—Ä–æ–ø–∏—Å–Ω—ã—Ö –±—É–∫–≤ –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞,
> —Ü–∏—Ñ—Ä, –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –∏ —Å–∫–æ–±–æ–∫ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ []{}().  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –ï—Å–ª–∏ —Å–∫–æ–±–∫–∏ –≤ _s_ —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã–≤–µ–¥–∏—Ç–µ
—Å—Ç—Ä–æ–∫—É "Success". –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–µ–¥–∏—Ç–µ –∏–Ω–¥–µ–∫—Å (–∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é —Å –µ–¥–∏–Ω–∏—Ü—ã) 
> –ø–µ—Ä–≤–æ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π. –ï—Å–ª–∏ —Ç–∞–∫–æ–π –Ω–µ—Ç, 
> –≤—ã–≤–µ–¥–∏—Ç–µ –∏–Ω–¥–µ–∫—Å –ø–µ—Ä–≤–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π.

–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç—ç–∫ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏.

–ö–æ–¥:
``` python
from collections import deque


def counting_braces(s):
    stack = deque([])
    braces = {'(': ')', '[': ']', '{': '}'}

    for i, ch in enumerate(s, 1):
        if ch in braces.keys():
            stack.append((ch, i))
        elif ch in braces.values():
            if not stack:
                return i
            elif ch == braces[stack[-1][0]]:
                stack.pop()
            else:
                return i

    if not stack:
        return 0
    return stack[-1][1]


def main():
    s = input()

    answer = counting_braces(s)
    if answer == 0:
        print('Success')
    else:
        print(answer)
```

## –í—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ _1 ‚â§ n ‚â§ 10<sup>5</sup>_. –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç _n_ —Ü–µ–ª—ã—Ö 
> —á–∏—Å–µ–ª _parent<sub>0</sub>, ..., parent<sub>n‚àí1</sub>_. –î–ª—è –∫–∞–∂–¥–æ–≥–æ _0 ‚â§ i ‚â§ n‚àí1_, _parenti_ ‚Äî —Ä–æ–¥–∏—Ç–µ–ª—å –≤–µ—Ä—à–∏–Ω—ã _i_; 
> –µ—Å–ª–∏ _parenti_ = _‚àí1_, —Ç–æ _i_ —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä–Ω–µ–º. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –∫–æ—Ä–µ–Ω—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –¥–∞–Ω–Ω–∞—è 
> –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–¥–∞—ë—Ç –¥–µ—Ä–µ–≤–æ.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –í—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞.

–°–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤—Ö–æ–¥–Ω–æ–π –º–∞—Å—Å–∏–≤ (–∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–∫–æ–º —Ä–æ–¥–∏—Ç–µ–ª–µ–π) –≤ —Å–ø–∏—Å–æ–∫ –¥–µ—Ç–µ–π (–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —Å–º–µ–∂–Ω–æ—Å—Ç–µ–π).
–°–æ–∑–¥–∞–¥–∏–º –æ—á–µ—Ä–µ–¥—å, –≤ –∫–æ—Ç–æ—Ä—É—é –¥–æ–±–∞–≤–∏–º –≤–µ—Ä—à–∏–Ω—É-–∫–æ—Ä–µ–Ω—å –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —É—Ä–æ–≤–Ω—è(–±–ª–∞–≥–æ–¥–∞—Ä—è –µ–º—É –º—ã —Å–º–æ–∂–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –∫–æ–≥–¥–∞
–º—ã –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ä–µ–≤–∞). –î–∞–ª–µ–µ –≤ —Ü–∏–∫–ª–µ –ø—Ä–æ—Ö–æ–¥—è –ø–æ –æ—á–µ—Ä–µ–¥–∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –∏–∑ –Ω–µ–µ –∫–∞–∂–¥—É—é –≤–µ—Ä—à–∏–Ω—É –∏ 
–¥–æ–±–∞–≤–ª—è–µ–º –µ–µ –¥–µ—Ç–µ–π. –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å, —Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –≤—ã—Å–æ—Ç—ã –Ω–∞ 1.

–ö–æ–¥:
``` python
def transformation(parents_list, n):
    adj_list = [[] for _ in range(n)]
    root_index = -1

    for child, parent in enumerate(parents_list, 1):
        if parent != -1:
            adj_list[parent].append(child - 1)
        else:
            root_index = child - 1

    return adj_list, root_index


def calc(_list):
    _list, root = transformation(_list, len(_list))
    height = 1
    queue = []

    queue.extend(_list[root])
    if len(queue) == 0:
        return height
    else:
        queue.append(-1)            # –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —É—Ä–æ–≤–Ω—è

    while queue:
        cur_peak = queue.pop(0)
        if cur_peak == -1:
            height += 1
            if queue: queue.append(-1)
        else:
            queue.extend(_list[cur_peak])

    return height


def main():
    n = int(input())
    print(calc(list(map(int, input().split()))))
```

## –°–∏–º—É–ª—è—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>–í–∞—à–∞ —Ü–µ–ª—å ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤. –î–ª—è i-–≥–æ –ø–∞–∫–µ—Ç–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ –≤—Ä–µ–º—è –µ–≥–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è 
> _arrival<sub>i</sub>_, –∞ —Ç–∞–∫–∂–µ –≤—Ä–µ–º—è _duration<sub>i</sub>_, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ –µ–≥–æ  –æ–±—Ä–∞–±–æ—Ç–∫—É. –í –≤–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏
> –∏–º–µ–µ—Ç—Å—è –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è. –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
> –ø–∞–∫–µ—Ç _i_ (—á—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è _duration<sub>i</sub>_), –æ–Ω –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ
> –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞–∫–µ—Ç.  
> –£ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–µ–≥–æ –ø–∞–∫–µ—Ç—ã, –∏–º–µ–µ—Ç—Å—è —Å–µ—Ç–µ–≤–æ–π –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–∞ _size_. –î–æ –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–∫–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è
> –≤ –±—É—Ñ–µ—Ä–µ. –ï—Å–ª–∏ –±—É—Ñ–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–æ–ª–Ω–µ–Ω –≤ –º–æ–º–µ–Ω—Ç –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞ (–µ—Å—Ç—å _size_ –ø–∞–∫–µ—Ç–æ–≤, –ø–æ—Å—Ç—É–ø–∏–≤—à–∏—Ö —Ä–∞–Ω–µ–µ, 
> –∫–æ—Ç–æ—Ä—ã–µ –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã), —ç—Ç–æ—Ç –ø–∞–∫–µ—Ç –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∏ —É–∂–µ –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç–æ–≤ 
> –ø–æ—Å—Ç—É–ø–∞–µ—Ç –≤ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è, –æ–Ω–∏ –≤—Å–µ –±—É–¥—É—Ç —Å–ø–µ—Ä–≤–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±—É—Ñ–µ—Ä (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑ –Ω–∏—Ö –º–æ–≥—É—Ç –±—ã—Ç—å 
> –æ—Ç–±—Ä–æ—à–µ–Ω—ã, –µ—Å–ª–∏ –±—É—Ñ–µ—Ä –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è). –ö–æ–º–ø—å—é—Ç–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è. –û–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
> —Å–ª–µ–¥—É—é—â–∏–π –ø–∞–∫–µ—Ç –∏–∑ –±—É—Ñ–µ—Ä–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç. –ö–æ–º–ø—å—é—Ç–µ—Ä –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–∞–∏–≤–∞—Ç—å, –µ—Å–ª–∏ 
> –≤—Å–µ –ø–∞–∫–µ—Ç—ã —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –≤ –±—É—Ñ–µ—Ä–µ –Ω–µ—Ç –ø–∞–∫–µ—Ç–æ–≤. –ü–∞–∫–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ –≤ –±—É—Ñ–µ—Ä–µ —Å—Ä–∞–∑—É –∂–µ, –∫–∞–∫ –∫–æ–º–ø—å—é—Ç–µ—Ä 
> –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫—É.
> 
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—Ö–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ _size_ –∏ —á–∏—Å–ª–æ –ø–∞–∫–µ—Ç–æ–≤ _n_. –ö–∞–∂–¥–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö _n_ 
> —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —á–∏—Å–ª–∞: –≤—Ä–µ–º—è _arrival<sub>i</sub>_ –ø—Ä–∏–±—ã—Ç–∏—è _i_-–≥–æ –ø–∞–∫–µ—Ç–∞ –∏ –≤—Ä–µ–º—è _duration<sub>i</sub>_, 
> –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ –µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∫—É. 
> –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ _arrival<sub>1</sub> ‚â§ arrival<sub>2</sub> ‚â§ ¬∑¬∑¬∑ ‚â§ arrival<sub>n</sub>_. –ü—Ä–∏ —ç—Ç–æ–º –º–æ–∂–µ—Ç 
> –æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ _arrival<sub>i - 1</sub> = arrival<sub>i</sub>_.
> –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –ø–∞–∫–µ—Ç _i ‚àí 1_ –ø–æ—Å—Ç—É–ø–∏–ª —Ä–∞–Ω—å—à–µ –ø–∞–∫–µ—Ç–∞ _i_.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ _n_ –ø–∞–∫–µ—Ç–æ–≤ –≤—ã–≤–µ–¥–∏—Ç–µ
> –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–∞—á–∞–ª –µ–≥–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –∏–ª–∏ _‚àí1_, –µ—Å–ª–∏ –ø–∞–∫–µ—Ç –±—ã–ª –æ—Ç–±—Ä–æ—à–µ–Ω.  
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.** –í—Å–µ —á–∏—Å–ª–∞ –≤–æ –≤—Ö–æ–¥–µ —Ü–µ–ª—ã–µ. _1 ‚â§ size ‚â§ 10<sup>5</sup>_; _0 ‚â§ n ‚â§ 10<sup>5</sup>_;
> _0 ‚â§ arrivali ‚â§ 10<sup>6</sup>_; _0 ‚â§ duration<sub>i</sub> ‚â§ 10<sup>4</sup>_; 
> _arrival<sub>i</sub> ‚â§ arrival<sub>i + 1</sub>_ –¥–ª—è –≤—Å–µ—Ö _1 ‚â§ i ‚â§ n ‚àí 1_.

–ó–∞–≤–µ–¥–µ–º –æ—á–µ—Ä–µ–¥—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –±—É—Ñ–µ—Ä. –ü—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, 
–≤ –∫–∞–∫–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤ –æ—á–µ—Ä–µ–¥–∏. –ï—Å–ª–∏ —ç—Ç–æ —á–∏—Å–ª–æ –Ω–µ –±–æ–ª—å—à–µ, —á–µ–º –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏,
–≤ –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç—É–ø–∏–ª —Ç–µ–∫—É—â–∏–π –ø–∞–∫–µ—Ç(–≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤ –±—É—Ñ–µ—Ä–µ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ), —Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ 
–æ—á–µ—Ä–µ–¥—å. –ï—Å–ª–∏ –±–æ–ª—å—à–µ, —Ç–æ –ø–∞–∫–µ—Ç –±—É–¥–µ—Ç –æ—Ç–±—Ä–æ—à–µ–Ω. 

–ö–æ–¥:
``` python
from collections import deque


def processing(buf_size, packets):
    buffer = deque([], maxlen=buf_size)
    answer = []
    for i in range(buf_size):
        buffer.append(0)

    for pack in packets:
        if buffer[0] <= pack[0]:
            answer.append(max(buffer[-1], pack[0]))
            buffer.append(max(buffer[-1], pack[0]) + pack[1])
        else:
            answer.append(-1)

    return answer


def main():
    buf_size, num_p = map(int, input().split())
    if num_p == 0:
        return
    packets = [list(map(int, input().split())) for _ in range(num_p)]

    print('\n'.join(map(str, processing(buf_size, packets))))
```

## –°—Ç–µ–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞–∫—Å–∏–º—É–º–∞
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>–í –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ –≤–∞—à–∞ —Ü–µ–ª—å ‚Äî —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–µ–∫–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª –æ–ø–µ—Ä–∞—Ü–∏—é max 
> –∏ –ø—Ä–∏ —ç—Ç–æ–º —á—Ç–æ–±—ã –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –±—ã–ª–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–º.  
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤ _q_. –ö–∞–∂–¥–∞—è –∏–∑ 
> –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö _q_ —Å—Ç—Ä–æ–∫ –∑–∞–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤: push v, pop, or max.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ max –≤—ã–≤–µ–¥–∏—Ç–µ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ) —Ç–µ–∫—É—â–∏–π –º–∞–∫—Å–∏–º—É–º –Ω–∞ —Å—Ç–µ–∫–µ.  
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.** _1 ‚â§ q ‚â§ 400 000_, _0 ‚â§ v ‚â§ 100 000_.

–ö–æ–¥:
``` python
import re
from sys import stdin, stdout


def proc_stack_command(com, stack):
    if re.match(r'push', com):
        v1 = int(com.split()[-1])
        if len(stack) == 0 or v1 > stack[-1][1]:
            v2 = v1
        else:
            v2 = stack[-1][1]
        stack.append([v1, v2])
    elif re.match(r'pop$', com):
        if stack:
            stack.pop()
    elif re.match(r'max$', com):
        if stack:
            return stack[-1][1]
        return 0


def main():
    n = int(stdin.readline())

    stack = []
    for _ in range(n):
        answ = proc_stack_command(stdin.readline(), stack)
        if type(answ) == int:
            stdout.write(str(answ) + '\n')
```

## –ú–∞–∫—Å–∏–º—É–º –≤ —Å–∫–æ–ª—å–∑—è—â–µ–º –æ–∫–Ω–µ
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>–ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º—É–º –≤ –∫–∞–∂–¥–æ–º –æ–∫–Ω–µ —Ä–∞–∑–º–µ—Ä–∞ _m_ –¥–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —á–∏—Å–µ–ª _A[1 . . . n]_.  
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—Ö–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–æ _n_, –≤—Ç–æ—Ä–∞—è ‚Äî –º–∞—Å—Å–∏–≤ _A[1 . . . n]_, —Ç—Ä–µ—Ç—å—è ‚Äî —á–∏—Å–ª–æ _m_.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** _n ‚àí m + 1_ –º–∞–∫—Å–∏–º—É–º–æ–≤, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏.   
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.** _1 ‚â§ n ‚â§ 10<sup>5</sup>_, _1 ‚â§ m ‚â§ n_, _0 ‚â§ A[i] ‚â§ 10<sup>5</sup>_ –¥–ª—è –≤—Å–µ—Ö _1 ‚â§ i ‚â§ n_.  

–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ –¥–≤—É—Ö —Å—Ç–µ–∫–∞—Ö. 

–ö–æ–¥:
``` python
def to_put(q, num):
    if not q or q[-1][1] <= num:
        q.append([num, num])
    else:
        q.append([num, q[-1][1]])


def to_shift(q1, q2):
    for i in range(len(q1)):
        to_put(q2, q1.pop()[0])


def search_max_in_win(win_size, nums):
    q1 = []
    q2 = []
    answer = []

    for i in range(len(nums)):
        if len(q1) < win_size:
            to_put(q1, nums[i])

        if len(q1) == win_size:
            to_shift(q1, q2)
            answer.append(q2.pop()[1])
        elif q2:
            answer.append(max(q1[-1][1], q2[-1][1]))
            q2.pop()

    return answer


def main():
    n = int(input())
    nums = list(map(int, input().split()))
    win_size = int(input())

    print(' '.join(map(str, search_max_in_win(win_size, nums))))
```

## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫—É—á–∏

–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> –ü–µ—Ä–µ—Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —á–∏—Å–µ–ª —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–ª —Å–≤–æ–π—Å—Ç–≤—É –º–∏–Ω-–∫—É—á–∏.  
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞**. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–æ _n_. –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤ —á–∏—Å–µ–ª _A[0], ..., A[n ‚àí 1]_.    
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞**. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—ã—Ö–æ–¥–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —á–∏—Å–ª–æ –æ–±–º–µ–Ω–æ–≤ _m_, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—Ç—å –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤—É 
> _0 ‚â§ m ‚â§ 4n_. –ö–∞–∂–¥–∞—è –∏–∑ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö _m_ —Å—Ç—Ä–æ–∫ –¥–æ–ª–∂–Ω–∞ –∑–∞–¥–∞–≤–∞—Ç—å –æ–±–º–µ–Ω –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–∞—Å—Å–∏–≤–∞ A. –ö–∞–∂–¥—ã–π –æ–±–º–µ–Ω –∑–∞–¥–∞—ë—Ç—Å—è
> –ø–∞—Ä–æ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ _0 ‚â§ i != j ‚â§ n‚àí1_. –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –æ–±–º–µ–Ω–æ–≤ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –º–∞—Å—Å–∏–≤ –¥–æ–ª–∂–µ–Ω 
> –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –º–∏–Ω-–∫—É—á—É, —Ç–æ –µ—Å—Ç—å –¥–ª—è –≤—Å–µ—Ö _0 ‚â§ i ‚â§ n ‚àí 1_ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –¥–≤–∞ —É—Å–ª–æ–≤–∏—è:
> - –µ—Å–ª–∏ _2i + 1 ‚â§ n ‚àí 1_, —Ç–æ _A[i] < A[2i + 1]_.
> - –µ—Å–ª–∏ _2i + 2 ‚â§ n ‚àí 1_, —Ç–æ _A[i] < A[2i + 2]_. 
> 
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**. _1 ‚â§ n ‚â§ 105_; _0 ‚â§ A[i] ‚â§ 10<sup>9</sup>_ –¥–ª—è –≤—Å–µ—Ö _0 ‚â§ i ‚â§ n‚àí1_; –≤—Å–µ A[i] –ø–æ–ø–∞—Ä–Ω–æ —Ä–∞–∑–ª–∏—á–Ω—ã; 
> _i != j_.

–ö–æ–¥:
``` python
from math import floor
from sys import stdin, stdout
exchanges = []


class Heap:
    def __init__(self, arr):
        self.heap = arr

    def parent(self, i):
        return floor((i - 1) / 2)

    def left_child(self, i):
        return 2 * i + 1

    def right_child(self, i):
        return 2 * i + 2

    def sift_down(self, i, stack):
        max_i = i
        l = self.left_child(i)
        if l < len(self.heap) and self.heap[l] < self.heap[max_i]:
            max_i = l
        r = self.right_child(i)
        if r < len(self.heap) and self.heap[r] < self.heap[max_i]:
            max_i = r

        if i != max_i:
            exchanges.append([i, max_i])
            self.heap[i], self.heap[max_i] = self.heap[max_i], self.heap[i]
            self.sift_down(max_i, stack)


def build_heap(n, arr):
    arr = Heap(arr)
    for i in range(n // 2 - 1, -1, -1):
        stack = []
        arr.sift_down(i, stack)


def main():
    n = int(stdin.readline())
    arr = list(map(int, stdin.readline().split()))

    build_heap(n, arr)
    stdout.write(str(len(exchanges)) + '\n')
    if exchanges:
        stdout.write('\n'.join(map(lambda x: f'{x[0]} {x[1]}', exchanges)))
```

## –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> –í –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ –≤–∞—à–∞ —Ü–µ–ª—å ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á. –¢–∞–∫–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ 
> (–¥–∏—Å–ø–µ—Ç—á–µ—Ä—ã) –µ—Å—Ç—å –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.  
> –£ –≤–∞—Å –∏–º–µ–µ—Ç—Å—è _n_ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ _m_ –∑–∞–¥–∞—á. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –¥–∞–Ω–æ –≤—Ä–µ–º—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ –µ—ë 
> –æ–±—Ä–∞–±–æ—Ç–∫—É. –û—á–µ—Ä–µ–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –∫ –ø–µ—Ä–≤–æ–º—É –¥–æ—Å—Ç—É–ø–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É (—Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ,
> —Ç–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç—É —Ä–∞–±–æ—Ç—É).  
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞**. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤—Ö–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–∞ _n_ –∏ _m_. –í—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–∞ _t<sub>0</sub>, ..., 
> t<sub>m-1</sub>_, –≥–¥–µ _t<sub>i</sub>_ ‚Äî –≤—Ä–µ–º—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É i-–π –∑–∞–¥–∞—á–∏. 
> –°—á–∏—Ç–∞–µ–º, —á—Ç–æ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã, –∏ –∑–∞–¥–∞—á–∏ –Ω—É–º–µ—Ä—É—é—Ç—Å—è —Å –Ω—É–ª—è.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞**. –í—ã—Ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–æ–≤–Ω–æ _m_ —Å—Ç—Ä–æ–∫: i-—è (—Å—á–∏—Ç–∞—è —Å –Ω—É–ª—è) —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–æ–º–µ—Ä 
> –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏—Ç i-—é –∑–∞–¥–∞—á—É –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É, –∏ –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç.
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**. _1 ‚â§ n ‚â§ 10<sup>5</sup>_; _1 ‚â§ m ‚â§ 10<sup>5</sup>_; _0 ‚â§ t<sub>i</sub> ‚â§ 10<sup>9</sup>_.


–ö–æ–¥:
``` python
import heapq


def main():
    n, m = map(int, input().split())
    processors = []
    for i in range(n):
        heapq.heappush(processors, [0, i])

    for task_time in map(int, input().split()):
        proc = heapq.heappop(processors)
        print(f'{proc[1]} {proc[0]}')
        heapq.heappush(processors, [proc[0] + task_time, proc[1]])
```

## –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> –í–∞—à–∞ —Ü–µ–ª—å –≤ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å _n_ —Ç–∞–±–ª–∏—Ü, 
> –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç _1_ –¥–æ _n_, –Ω–∞–¥ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å—Ç–æ–ª–±—Ü–æ–≤ (–∞—Ç—Ä–∏–±—É—Ç–æ–≤). –ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏–±–æ 
> —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ, –ª–∏–±–æ —Å–∏–º–≤–æ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –¥—Ä—É–≥—É—é —Ç–∞–±–ª–∏—Ü—É. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–¥–µ—Ä–∂–∞—Ç 
> —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –∏ i-—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç _r<sub>i</sub>_ –∑–∞–ø–∏—Å–µ–π. –í–∞—à–∞ —Ü–µ–ª—å ‚Äî –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å _m_ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–∏–ø–∞ 
> (_destination<sub>i</sub>_, _source<sub>i</sub>_).  
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞**. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–∞ _n_ –∏ _m_ ‚Äî —á–∏—Å–ª–æ —Ç–∞–±–ª–∏—Ü –∏ —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –í—Ç–æ—Ä–∞—è 
> —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç _n_ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª _r<sub>1</sub>, ..., r<sub>n</sub>_ ‚Äî —Ä–∞–∑–º–µ—Ä—ã —Ç–∞–±–ª–∏—Ü. –ö–∞–∂–¥–∞—è –∏–∑ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö _m_ —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ 
> –Ω–æ–º–µ—Ä–∞ —Ç–∞–±–ª–∏—Ü _destination<sub>i</sub>_ –∏ _source<sub>i</sub>_, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞**. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ _m_ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã–≤–µ–¥–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è.  
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**. _1 ‚â§ n_, _m ‚â§ 100 000_; _0 ‚â§ r<sub>i</sub> ‚â§ 10 000_; _1 ‚â§ destination<sub>i</sub>_, 
> _source<sub>i</sub> ‚â§ n_.

–ö–æ–¥:
``` python
_max = 0


def find(i, parent):
    if i != parent[i]:
        parent[i] = find(parent[i], parent)
    return parent[i]


def union(dest, source, parent, rank):
    global _max
    d_parent = find(dest, parent)
    s_parent = find(source, parent)

    if d_parent != s_parent:
        parent[s_parent] = d_parent
        rank[d_parent] += rank[s_parent]
        _max = max(_max, rank[d_parent])
    return _max


def main():
    global _max

    n, m = map(int, input().split())    # —á–∏—Å–ª–æ —Ç–∞–±–ª–∏—Ü, —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤
    parent = [i for i in range(n)]
    rank = list(map(int, input().split()))
    _max = max(rank)

    for _ in range(m):
        dest, source = map(int, input().split())
        print(union(dest - 1, source - 1, parent, rank))
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º —Ü–µ–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –≤–∏–¥–∞ 
> _x<sub>i</sub> = x<sub>j</sub>_ –∏ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –≤–∏–¥–∞ _x<sub>p</sub> != x<sub>q</sub>_.
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–∞ _n_, _e_, _d_. –ö–∞–∂–¥–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö _e_ —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —á–∏—Å–ª–∞ 
> _i_ –∏ _j_ –∏ –∑–∞–¥–∞—ë—Ç —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ _x<sub>i</sub> = x<sub>j</sub>_. –ö–∞–∂–¥–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö _d_ —Å—Ç—Ä–æ–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —á–∏—Å–ª–∞ 
> _i_ –∏ _j_ –∏ –∑–∞–¥–∞—ë—Ç –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–æ _x<sub>i</sub> != x<sub>j</sub>_. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è —Å 1: 
> _x<sub>1</sub>, .., x<sub>n</sub>_.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –í—ã–≤–µ–¥–∏—Ç–µ 1, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º _x<sub>1</sub>, .., x<sub>n</sub>_ –º–æ–∂–Ω–æ –ø—Ä–∏—Å–≤–æ–∏—Ç—å —Ü–µ–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, 
> —á—Ç–æ–±—ã –≤—Å–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –∏ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –≤—ã–ø–æ–ª–Ω–∏–ª–∏—Å—å. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–µ–¥–∏—Ç–µ 0.  
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.** _1 ‚â§ n ‚â§ 10<sup>5</sup>_; _0 ‚â§ e, d_; _e + d ‚â§ 2 ¬∑ 10<sup>5</sup>_; _1 ‚â§ i, j ‚â§ n_.


–ö–æ–¥:
``` python
def find(i, parent):
    if i != parent[i]:
        parent[i] = find(parent[i], parent)
    return parent[i]


def union(i, j, parent, rank):
    i_parent = find(i, parent)
    j_parent = find(j, parent)

    if i_parent == j_parent:
        return
    if rank[i_parent] > rank[j_parent]:
        parent[j_parent] = i_parent
    else:
        parent[i_parent] = j_parent
        if rank[i_parent] == rank[j_parent]:
            rank[j_parent] += 1


def main():
    n, e, d = map(int, input().split())  # —á–∏—Å–ª–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ–ª-–≤–æ —Ä–∞–≤–µ–Ω—Å—Ç–≤, –∫–æ–ª-–≤–æ –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤
    parents = [i for i in range(n)]
    rank = [1 for _ in range(n)]

    code = 1
    if e != 0:
        for i in range(e):
            n1, n2 = map(int, input().split())
            union(n1 - 1, n2 - 1, parents, rank)

    if d != 0:
        for i in range(d):
            n1, n2 = map(int, input().split())
            if find(n1 - 1, parents) == find(n2 - 1, parents):
                code = 0

    print(code)
```


## –¢–µ–ª–µ—Ñ–æ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
> –¶–µ–ª—å –≤ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–µ ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—É—é –∫–Ω–∏–≥—É, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é —Ç—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–æ–≤. 
> –° —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –¥–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä—è–º–æ–π –∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π.
> - `add number name`: –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å —Å –∏–º–µ–Ω–µ–º _name_ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º _number_. –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º
    > –Ω–æ–º–µ—Ä–æ–º —É–∂–µ –µ—Å—Ç—å, –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –≤ –Ω–µ–π –∏–º—è –Ω–∞ _name_. 
> - `del number`: —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º. –ï—Å–ª–∏ —Ç–∞–∫–æ–π –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å.
> - `find number`: –Ω–∞–π—Ç–∏ –∏–º—è –∑–∞–ø–∏—Å–∏ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º _number_. –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º –µ—Å—Ç—å, –≤—ã–≤–µ—Å—Ç–∏ –∏–º—è. 
    > –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–µ—Å—Ç–∏ _¬´not found¬ª_ (–±–µ–∑ –∫–∞–≤—ã—á–µ–∫).  
> 
> **–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–∞.** –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤ _n_. –ö–∞–∂–¥–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö _n_ —Å—Ç—Ä–æ–∫ –∑–∞–¥–∞—ë—Ç –∑–∞–ø—Ä–æ—Å –≤ –æ–¥–Ω–æ–º –∏–∑ 
> —Ç—Ä—ë—Ö –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤—ã—à–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤.  
> **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ find –≤—ã–≤–µ–¥–∏—Ç–µ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –ª–∏–±–æ –∏–º—è, –ª–∏–±–æ ¬´not found¬ª.  
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.** _1 ‚â§ n ‚â§ 10<sup>5</sup>_. –¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –Ω–µ –±–æ–ª–µ–µ —Å–µ–º–∏ —Ü–∏—Ñ—Ä –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤–µ–¥—É—â–∏—Ö 
> –Ω—É–ª–µ–π. –ò–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞, –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –∏–º–µ—é—Ç –¥–ª–∏–Ω—É –Ω–µ –±–æ–ª—å—à–µ 15.
> –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Å—Ä–µ–¥–∏ –∏–º—ë–Ω –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ ¬´not found¬ª.


–ö–æ–¥:
``` python
phone_book = dict()


def add_in_book(entry):
    phone_num, name = entry.split()
    phone_book[phone_num] = name


def del_from_book(phone_num):
    phone_book.pop(phone_num, '')


def main():
    n = int(input())
    for i in range(n):
        request, entry = input().split(maxsplit=1)
        if request == 'add':
            add_in_book(entry)
        elif request == 'del':
            del_from_book(entry)
        elif request == 'find':
            print(phone_book.get(entry, 'not found'))
```


## –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∞–º–∏
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>

–¢–µ–∫—Å—Ç

–ö–æ–¥:
``` python

```

<!---
## –ù–∞–∑–≤–∞–Ω–∏–µ
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
>

–¢–µ–∫—Å—Ç

–ö–æ–¥:
``` python

```
-->